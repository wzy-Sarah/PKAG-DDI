{
  "stage":"second",
  "max_epochs": 40,
  "learning_rate": 0.001,
  "init_checkpoint": "./all_checkpoints/stage2/stage2.ckpt",
  "device": "0,1",
  "work_dir": "",
  "caption_eval_epoch": 1,
  "save_every_n_epochs":2,
  "patience":3,
  "min_delta":0.0002,
  "dataset": {
    "name": "mecddi_or_ddinter",
    "prompt_model": "retrieval_paircheng",
    "batch_size": 4,
    "inference_batch_size":4,
    "retrieval_function_number":2,
    "num_workers": 4,
    "mode": "ft",
    "text_max_len": 256,
    "num_single_mol_token": 8,
     "mol_prompt1": "The first drug is [START_I_SMILES]{}[END_I_SMILES] [START_MOL][END_MOL]. [START_CoT]The function is {}[END_CoT].",
    "mol_prompt2": "The second drug is [START_I_SMILES]{}[END_I_SMILES] [START_MOL][END_MOL]. [START_CoT]The function is {}[END_CoT].",
    "train_root": "./data/ddinter_inputdata/train_random_split1/",
    "valid_root": "./data/ddinter_inputdata/test_random_split1/",
    "test_root": "./data/ddinter_inputdata/test_random_split1/"
  },
  "model":{
    "name": "Function_gen",
    "batch_size": 4,
    "retrieval_function_number":2,
    "stage":"marginalize",
    "DDI": true,
    "do_sample":true,
    "max_new_tokens":256,
    "num_beams": 5,
    "generate_max_len": 20,
    "generate_min_len": 5,
    "temperature":0.1,
    "top_p":0.5,
    "repetition_penalty":1.5,
    "gin_num_layers": 5,
    "gin_hidden_dim": 300,
    "gin_drop_ratio": 0.0,
    "tune_gnn": false,
    "num_query_token": 8,
    "bert_name": "scibert",
    "cross_attention_freq": 2,
    "opt_model": "facebook/galactica-1.3b",
    "llm_tune": "lora",
    "peft_dir": "",
    "lora_r": 8,
    "lora_alpha": 32,
    "lora_dropout": 0.1,
    "warmup_steps": 1000,
    "init_lr": 1e-4,
    "weight_decay": 0.05,
    "scheduler": "linear_warmup_cosine_lr",
    "max_epochs": 30,
    "min_lr": 1e-5,
    "warmup_lr": 1e-6,
    "lr_decay_rate": 0.9
  }

}